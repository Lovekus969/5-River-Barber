<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Owner Dashboard - Manage Appointments</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="styles.css" /> <!-- Link to your global site CSS -->

  
</head>
   <nav class="navbar">

  <!-- 3-dot icon -->
  <div class="menu-dots" onclick="toggleSidebar()">‚ãØ</div>

  <!-- Desktop nav -->
  <ul>
    <li><a href="index.html#home">Home</a></li>
    <li><a href="index.html#services">Services</a></li>
    <li><a href="index.html#gallery">Gallery</a></li>
    <li><a href="index.html#about">About Us</a></li>
    <li><a href="booking.html">Book Now</a></li>
    <li><a href="index.html#contact">Contact</a></li>
  </ul>

  <!-- Sidebar for mobile -->
  <div class="sidebar" id="mobileSidebar">
    <ul>
      <li><a href="index.html#home">Home</a></li>
      <li><a href="index.html#services">Services</a></li>
      <li><a href="index.html#gallery">Gallery</a></li>
      <li><a href="index.html#about">About Us</a></li>
      <li><a href="booking.html">Book Now</a></li>
      <li><a href="index.html#contact">Contact</a></li>
    </ul>
  </div>
</nav>
<br>

<br>
<br>
<br>
<body class="owner-dashboard">
   

  <!-- Optional: You can copy the site's navbar here if needed -->

  <h2>       üì¨ Manage Appointments - Owner Dashboard</h2>

  <div>
    <label for="location-filter">Filter by Location:</label>
    <select id="location-filter">
      <option value="">All Locations</option>
      <option value="Olivia Marie Gardens">Olivia Marie Gardens</option>
      <option value="Main Street">Main Street</option>
    </select>
  </div>

  <div>
    <label for="search-input">Search (Name or Barber):</label>
    <input type="text" id="search-input" placeholder="Type to search..." />
  </div>

  <ul id="appointments-list">
    <!-- Appointments will be rendered here -->
  </ul>
<!-- Add this inside your body above the script or inside your dashboard container -->

<!-- Add sorting buttons and export -->
<div style="margin: 20px 0; display: flex; gap: 15px; flex-wrap: wrap; align-items: center;">
  <label for="sort-select" style="font-weight:bold;">Sort by Date:</label>
  <select id="sort-select" style="padding: 8px; border-radius: 5px; border: 1px solid #ccc;">
    <option value="asc" selected>Ascending</option>
    <option value="desc">Descending</option>
  </select>

  <button id="export-btn" style="padding: 8px 15px; background: #ffcb47; border: none; border-radius: 5px; cursor: pointer;  color: #000;font-weight: bold;">
    Export CSV
  </button>
</div>

<p id="appointments-count" style="font-weight: bold; margin-bottom: 20px; color: #000000;"></p>

<hr style="margin: 40px 0; border-top: 2px solid #000000;">

<section id="barber-calculator" style="background:#8f8b8b; color:#fff; padding:30px; border-radius:12px; max-width:600px; margin:40px auto; font-family:sans-serif;">
  <h2 style="color:#ffcb47; text-align:center;">üíà Daily Income Calculator</h2>

  <div style="display:flex; flex-direction:column; gap:15px; margin-top:20px;">
    <label>
      Walk-in Cash ($)
      <input type="number" id="walkinCash" placeholder="0.00" min="0" step="0.01" style="width:100%; padding:10px; border-radius:6px; border:none;">
    </label>

    <label>
      Debit/Credit Payments ($)
      <input type="number" id="cardPayments" placeholder="0.00" min="0" step="0.01" style="width:100%; padding:10px; border-radius:6px; border:none;">
    </label>

    <label>
      Tips ($)
      <input type="number" id="tips" placeholder="0.00" min="0" step="0.01" style="width:100%; padding:10px; border-radius:6px; border:none;">
    </label>

    <label>
      Expenses ($)
      <input type="number" id="expenses" placeholder="0.00" min="0" step="0.01" style="width:100%; padding:10px; border-radius:6px; border:none;">
    </label>

    <button onclick="calculateBarberIncome()" style="padding:12px; background:#ffcb47; color:#000; font-weight:bold; border:none; border-radius:8px; cursor:pointer;">Calculate</button>
  </div>

  <div id="incomeResults" style="margin-top:30px; text-align:center;">
    <p>Total Income: <strong>$<span id="totalIncome">0.00</span></strong></p>
    <p>Net Profit (After Expenses): <strong>$<span id="netProfit">0.00</span></strong></p>
  </div>
</section>

  <!-- Footer Section -->
<footer class="footer" id="footer-section">
  <div class="container">
    <h3>Opening Hours</h3>
    <ul class="shop-hours">
      <li>Saturday: 9:30 a.m. ‚Äì 9:00 p.m.</li>
      <li>Sunday: 9:30 a.m. ‚Äì 9:00 p.m.</li>
      <li>Monday: 9:30 a.m. ‚Äì 9:00 p.m.</li>
      <li>Tuesday: 9:30 a.m. ‚Äì 9:00 p.m.</li>
      <li>Wednesday: 9:30 a.m. ‚Äì 9:00 p.m.</li>
      <li>Thursday: 9:30 a.m. ‚Äì 9:00 p.m.</li>
      <li>Friday: 9:30 a.m. ‚Äì 9:00 p.m.</li>
    </ul>
    <div class="shop-location" id="contact">
      <h2 style="color: #d4af37;">Contact Us</h2>
      <p>Email: <a href="mailto:info@5riverbarbers.com" style="color: #d4af37;">info@5riverbarbers.com</a></p>
     
      <p><strong>üìç Olivia Marie Gardens</strong></p>
      <p>In plaza side, 20 Sky Harbour Dr, Brampton, ON L6Y 0V7</p>
      <p><i class="fas fa-phone-alt"></i> <a href="tel:9054600999">(905) 460-0999</a></p>
    </div>

    <div class="shop-location">
      <p><strong>üìç Main Street</strong></p>
      <p>332 Main St N, Brampton, ON L6V 1P8</p>
      <p><i class="fas fa-phone-alt"></i> <a href="tel:9059569544">(905) 956-9544</a></p>
    </div>
     <!-- Social Media Links -->
     <div class="social-links" style="margin-top: 20px;">
      <h3 style="color: #fff;">Follow Us</h3>
      <a href="https://www.tiktok.com/@5riversbarbershop" target="_blank" style="margin-right: 15px;">
        <img src="Images/tik-tok.jpg" alt="TikTok" style="width: 32px; height: 32px;">
      </a>
      <a href="https://www.instagram.com/5rivers_barbershop/" target="_blank">
        <img src="Images/insta.jpg" alt="Instagram" style="width: 32px; height: 32px;">
      </a>
    </div>

    <p>
  &copy; 2025 5 Rivers Barbers. All rights reserved. 
  Made by <a href="https://www.linkedin.com/in/bhavneet-bhavneet-300998295/" target="_blank" style="color: rgb(8, 112, 181);">Kush</a>
</p>

    <a href="index.html" class="back-to-top" style="color: black;">‚¨Ü Back to Home</a>

  </div>

</footer>

<script>
  function calculateBarberIncome() {
    const walkin = parseFloat(document.getElementById("walkinCash").value) || 0;
    const card = parseFloat(document.getElementById("cardPayments").value) || 0;
    const tips = parseFloat(document.getElementById("tips").value) || 0;
    const expenses = parseFloat(document.getElementById("expenses").value) || 0;

    const totalIncome = walkin + card + tips;
    const netProfit = totalIncome - expenses;

    document.getElementById("totalIncome").textContent = totalIncome.toFixed(2);
    document.getElementById("netProfit").textContent = netProfit.toFixed(2);
  }





    (function checkPassword() {
  const correctPassword = '@1313'; // replace with your actual password

  let entered = prompt("Enter Owner Password:");

  if (entered !== correctPassword) {
    alert("Wrong password! Redirecting...");
    window.location.href = 'index.html';  // Redirect to homepage or login page
  }
})();

    const appointments = JSON.parse(localStorage.getItem('appointments') || '[]');
    const list = document.getElementById('appointments-list');
    const locationFilter = document.getElementById('location-filter');
    const searchInput = document.getElementById('search-input');
    const sortSelect = document.getElementById('sort-select');
    const exportBtn = document.getElementById('export-btn');
    const countDisplay = document.getElementById('appointments-count');
   
    function formatDateForCompare(dateStr) {
        // Format yyyy-mm-dd to comparable Date object
        return new Date(dateStr);
      }

      function isToday(dateStr) {
        const today = new Date();
        const d = new Date(dateStr);
        return (
          d.getDate() === today.getDate() &&
          d.getMonth() === today.getMonth() &&
          d.getFullYear() === today.getFullYear()
        );
      }

    function renderAppointments() {
      const filterLoc = locationFilter.value.toLowerCase();
      const searchTerm = searchInput.value.toLowerCase();
     const sortOrder = sortSelect.value;
      const filtered = appointments.filter(appt => {
        const matchesLocation = filterLoc === '' || appt.location.toLowerCase() === filterLoc;
        const matchesSearch =
          appt.name.toLowerCase().includes(searchTerm) ||
          appt.barber.toLowerCase().includes(searchTerm);
        return matchesLocation && matchesSearch;
      });
        // Sort filtered appointments by date
        filtered.sort((a, b) => {
          const dateA = formatDateForCompare(a.date);
          const dateB = formatDateForCompare(b.date);
          return sortOrder === 'asc' ? dateA - dateB : dateB - dateA;
        });

      list.innerHTML = '';
      if (filtered.length === 0) {
        list.innerHTML = '<p class="no-appointments">No appointments found.</p>';
        return;
      }
  countDisplay.textContent = `Showing ${filtered.length} appointment${filtered.length !== 1 ? 's' : ''}`;
      filtered.forEach((appt, i) => {
        const li = document.createElement('li');
        li.className = 'appointment-card';

        // Highlight today‚Äôs appointments
    if (isToday(appt.date)) {
      li.style.backgroundColor = '#444422'; // dark gold-ish background
      li.style.boxShadow = '0 0 10px #d4af37';
    } else {
      li.style.backgroundColor = '#222';
      li.style.boxShadow = '0 0 6px #d4af37';
    }



        li.innerHTML = `
          <div class="appointment-header">${i + 1}. ${appt.name} ‚Äî <em>${appt.location}</em></div>
          <div class="appointment-details">
            <strong>Barber:</strong> ${appt.barber}<br/>
            <strong>Date & Time:</strong> ${appt.date} @ ${appt.time}<br/>
            <strong>Phone:</strong> ${appt.phone}<br/>
            <strong>Email:</strong> ${appt.email}<br/>
            <strong>Notes:</strong> ${appt.notes || 'None'}
          </div>
      <button class="delete-btn" data-index="${i}" style="margin-top:10px; background:#d43f3f; color:#fff; border:none; padding:6px 12px; border-radius:5px; cursor:pointer;">
        Delete
      </button>

        `;
        list.appendChild(li);
      });


       // Attach delete listeners after rendering
  document.querySelectorAll('.delete-btn').forEach(btn => {
    btn.addEventListener('click', () => {
      const idx = parseInt(btn.getAttribute('data-index'), 10);
      const appt = filtered[idx];

      if (confirm(`Delete appointment for ${appt.name} on ${appt.date} at ${appt.time}?`)) {
        // Remove from global appointments array by finding matching object
        const globalIndex = appointments.findIndex(a =>
          a.name === appt.name &&
          a.date === appt.date &&
          a.time === appt.time &&
          a.location === appt.location
        );
        if (globalIndex > -1) {
          appointments.splice(globalIndex, 1);
          localStorage.setItem('appointments', JSON.stringify(appointments));
          renderAppointments(); // re-render list
        }
      }
    });
  });
}

// Export appointments to CSV
function exportToCSV() {
  if (appointments.length === 0) {
    alert('No appointments to export!');
    return;
  }

  const header = ['Name', 'Email', 'Phone', 'Notes', 'Location', 'Barber', 'Date', 'Time'];
  const csvRows = [];

  // Add header row
  csvRows.push(header.join(','));

  // Add data rows
  appointments.forEach(appt => {
    const row = [
      `"${appt.name}"`,
      `"${appt.email}"`,
      `"${appt.phone}"`,
      `"${(appt.notes || '').replace(/"/g, '""')}"`,
      `"${appt.location}"`,
      `"${appt.barber}"`,
      `"${appt.date}"`,
      `"${appt.time}"`
    ];
    csvRows.push(row.join(','));
  });

  const csvString = csvRows.join('\n');
  const blob = new Blob([csvString], { type: 'text/csv' });
  const url = URL.createObjectURL(blob);

  const a = document.createElement('a');
  a.href = url;
  a.download = 'appointments.csv';
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);
  URL.revokeObjectURL(url);






    }

    // Initial render
    renderAppointments();

    // Event listeners
    locationFilter.addEventListener('change', renderAppointments);
    searchInput.addEventListener('input', renderAppointments);
    sortSelect.addEventListener('change', renderAppointments);
    exportBtn.addEventListener('click', exportToCSV);


  </script>
  <script>
function toggleSidebar() {
  const sidebar = document.getElementById("mobileSidebar");
  sidebar.classList.toggle("show");
}

// Close sidebar when a link is clicked
document.querySelectorAll('.sidebar a').forEach(link => {
  link.addEventListener('click', () => {
    document.getElementById("mobileSidebar").classList.remove("show");
  });
});

 function formatTime12Hour(time24) {
  // time24 is like "14:30" or "09:05"
  const [hourStr, minute] = time24.split(':');
  let hour = parseInt(hourStr, 10);
  const ampm = hour >= 12 ? 'PM' : 'AM';
  hour = hour % 12;
  if (hour === 0) hour = 12; // 0 hour is 12 AM
  return `${hour}:${minute} ${ampm}`;
}

</script>

<script src="Confused.js"></script>

<script src="dashboard-utils.js"></script>
<script src="dashboard-events.js"></script>

</body>
</html>
